/**
 * Created by vshkulev on 12/17/15.
 */

var app = require('app');
var BrowserWindow = require('browser-window');
var path = require('path');
var mainWindow = null;
var updater = require('electron-updater');

app.on('window-all-closed', function () {
    if (process.platform !== 'darwin') {
        app.quit();
    }
});

app.on('ready', function () {
    updater.on('ready', function () {
        mainWindow = new BrowserWindow({width: 800, height: 600});
        mainWindow.loadURL(path.join('file://', __dirname, 'main.html'));
        mainWindow.setMenu(null);
        mainWindow.webContents.openDevTools();

        mainWindow.on('closed', function () {
            mainWindow = null;
            //app.quit();
        });
    });

    updater.on('updateRequired', function () {
        console.log('updateRequired in mian.js');
        app.quit();
    });

    updater.on('updateAvailable', function () {
        mainWindow.webContents.send('update-available');
        console.log('updateAvailable');
    });

    updater.start();
});
